{"version":3,"sources":["index.ts"],"names":[],"mappings":"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","file":"index.js","sourceRoot":"..","sourcesContent":["import { InputController } from \"./input_controller\";\r\nimport { NoGarethGame } from \"./nogarethgame\";\r\nimport { DATA, SOUND_FILES } from \"./data\";\r\nimport { BOBAPI } from \"./bob\";\r\n\r\ndeclare var window,rivets,$, Tone;\r\n\r\nexport class MyApp {\r\n\r\n    message:string = '';\r\n    ctx:CanvasRenderingContext2D;\r\n\tcanvas:HTMLCanvasElement;\r\n    nogarethGame:NoGarethGame;\r\n    inputController:InputController;\r\n    _data = DATA; //for debugging\r\n    _bobapi = BOBAPI; //for debugging\r\n    mobileMode: boolean = false;\r\n    firstTimeLoad: boolean = true;\r\n    lastFrameTime:DOMHighResTimeStamp = 0;\r\n    fps:number = 45;\r\n\r\n    constructor() {\r\n\r\n        //rivets is a handy data binding library for html front ends\r\n        this.bindRivets();\r\n\r\n        //setup canvas\r\n        this.canvas = document.getElementById('my-canvas') as HTMLCanvasElement;\r\n        this.ctx = this.canvas.getContext('2d');\r\n\r\n        this.detectMobile();\r\n        this.load();\r\n    }\r\n\r\n    async load(){\r\n\r\n        //load game files\r\n        await DATA.LoadAsync();\r\n        $('#divLoading').hide();\r\n        $('#divMain').show();\r\n    }\r\n\r\n    //callback after all sounds finish loading\r\n    //current not being used because loadAllSounds\r\n    //needs to run after a button click\r\n    finishedLoading(){\r\n\r\n    }\r\n\r\n    bindRivets(){\r\n        rivets.bind($('body'), {data:this});\r\n    }\r\n    \r\n    btnClick(){\r\n        if (this.firstTimeLoad){\r\n\r\n            //get audio working after user interaction\r\n            Tone.context.resume();\r\n            BOBAPI.LoadAllSounds();\r\n\r\n            \r\n\r\n            if (this.mobileMode) {\r\n                $(\"#mobileDiv\").show();\r\n                $('#my-canvas').width(window.innerWidth);\r\n                $('#my-canvas').appendTo(\"#mobileCanvas\");\r\n                $(\"#my-canvas\").show();\r\n                $(\"#divMain\").hide();\r\n                $(\"#btnHideMenu\").show();\r\n                \r\n                \r\n                let halfWidth = (window.innerWidth / 2) - 35;\r\n                document.getElementById(\"menuDiv\").style.left = halfWidth + \"px\";\r\n                this.inputController = new InputController('divTouchSurface');\r\n    \r\n                //scroll back to top\r\n                try\r\n                {\r\n                    document.body.scrollTop = 0; // For Safari\r\n                    document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera\r\n                }catch(error){}\r\n                \r\n    \r\n            }\r\n            else {\r\n                $(\"#btnFullScreen\").show();\r\n                $(\"#my-canvas\").show();\r\n                this.inputController = new InputController('my-canvas');\r\n            }\r\n            this.inputController.KeyMappings = {\r\n                Mapping_Left:'ArrowLeft',\r\n                Mapping_Right:'ArrowRight',\r\n                Mapping_Up:'ArrowUp',\r\n                Mapping_Down:'ArrowDown',\r\n                Mapping_Action_1:'a',\r\n                Mapping_Action_2:'s',\r\n                Mapping_Action_3:'z',\r\n                Mapping_Action_4:'x',\r\n                Mapping_Action_5:'d',\r\n                Mapping_Action_6:'c',\r\n                Mapping_Action_7:'f',\r\n                Mapping_Start:'Enter',\r\n                Mapping_Select:'Shift'\r\n            };\r\n            this.inputController.setupGamePad();\r\n\r\n            \r\n            this.nogarethGame = new NoGarethGame(this.ctx, this.inputController);\r\n\r\n            //setup animation loop\r\n            window.requestAnimationFrame(this.draw.bind(this));\r\n            this.firstTimeLoad = false;\r\n        }\r\n        else{\r\n            this.nogarethGame = new NoGarethGame(this.ctx, this.inputController);\r\n            if (this.mobileMode)\r\n                this.btnHideMenu();\r\n        }\r\n\r\n        $(\"#btnPlayGame\").hide();\r\n    }\r\n\r\n\r\n    draw(timestamp:DOMHighResTimeStamp){\r\n\t\twindow.requestAnimationFrame(this.draw.bind(this));\r\n\r\n        if (timestamp - this.lastFrameTime >= 1000 / this.fps) {\r\n         \r\n            if (this.nogarethGame) {\r\n                this.nogarethGame.Game_Main();\r\n                this.lastFrameTime = performance.now()\r\n            }\r\n        }\r\n        \r\n    }\r\n\r\n    detectMobile(){\r\n        if (window.innerWidth < 600 || navigator.userAgent.toLocaleLowerCase().toLocaleLowerCase().includes('iphone') ||\r\n            navigator.userAgent.toLocaleLowerCase().toLocaleLowerCase().includes('ipad') ) {\r\n            this.mobileMode = true;\r\n        }\r\n\r\n    }\r\n    \r\n    btnHideMenu() {\r\n        $('#divMain').hide();\r\n        $('#menuDiv').show();\r\n    }\r\n\r\n    btnFullScreen(){\r\n        this.canvas.requestFullscreen();\r\n    }\r\n\r\n}\r\n\r\nwindow.myApp = new MyApp();"]}